{% extends "base.html" %}
{% load static %}

{% block main %}
<main class="main-content">
        <div class="product-container">
            <!-- Product Images -->
            <div class="product-images">
                {% for image in product.images.all %}
                <div class="thumbnail active">
                    <img src="{{ image.image.url }}" alt="">
                </div>
                {% endfor %}
            </div>

            <!-- Main Image -->
            <div class="main-image-container">
                {% comment %} <div class="discount-badge">–°–ö–ò–î–ö–ê 21 %</div> {% endcomment %}
                <img src="{{ product.get_first_photo }}" class="main-image" id="mainProductImage">
            </div>

            <!-- Product Info -->
            <div class="product-info">
                {% comment %} <div class="product-code">63127</div> {% endcomment %}
                
                {% if product.availability %}
                <div class="stock-status">
                    ‚úì –ù–∞ —Å–∫–ª–∞–¥–µ
                </div>
                {% else %}
                <div class="stock-status">
                    ‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
                </div>
                {% endif %}

                <div class="brand">{{ product.manufacturer }}</div>
                
                <h1 class="product-title">{{ product.title }}</h1>
                
                <div class="package-options">
                    <div class="package-label">–§–∞—Å–æ–≤–∫–∞</div>
                    <div class="package-option">
                        <div class="package-radio selected"></div>
                        <span class="package-text">{{ product.quantity }}</span>
                    </div>
                </div>
                
                 <div class="price-section">
                    <span class="current-price">{{ product.price }} ‚ÇΩ</span>
                </div>

                {% if product.availability %}

                <form action="{% url "cart_add" product.id %}" method='post'>
                {{ cart_product_form }}
                <button class="buy-button" id="buy-button">
                            üõí –ö–£–ü–ò–¢–¨
                </button>
                {% csrf_token %}
                </form>


                {% else %}
                <h1 style="color: #4CAF50;">–ö –°–æ–∂–∏–ª–µ–Ω–∏—é —Ç–æ–≤–∞—Ä–∞ –Ω–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏üòû</h1>
                {% endif %}
            </div>
        </div>

        <!-- Product Description -->
        <div class="product-description">
            <h2 class="description-title">–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h2>
                {% for decription_image in product.decription_images.all %}
                <img src="{{ decription_image.decription_image.url }}" class="product-discription-photo">
                {% endfor %}
            <div class="description-content">
                <p>{{ product.discription|safe }}</p>
                <h2 class="description-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h2>
                <p>{{ product.additional_information|safe }}</p>
            </div> 
        </div>
    </main>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ + –∏ -
    document.querySelectorAll('.quantity-btn.plus').forEach(btn => {
        btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            const input = document.getElementById(`quantity-${productId}`);
            input.value = parseInt(input.value) + 1;
            document.getElementById(`submit-${productId}`).click();
        });
    });

    document.querySelectorAll('.quantity-btn.minus').forEach(btn => {
        btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-product-id');
            const input = document.getElementById(`quantity-${productId}`);
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
                document.getElementById(`submit-${productId}`).click();
            }
        });
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø—Ä—è–º–æ–≥–æ –≤–≤–æ–¥–∞ —á–∏—Å–ª–∞
    document.querySelectorAll('.quantity-input').forEach(input => {
        input.addEventListener('change', function() {
            const productId = this.id.split('-')[1];
            if (this.value < 1) this.value = 1;
            document.getElementById(`submit-${productId}`).click();
        });
    });
});
</script>

{% endblock main %}
